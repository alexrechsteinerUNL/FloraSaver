<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="FloraSaver.PlantDetailsPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:ios="clr-namespace:Microsoft.Maui.Controls.PlatformConfiguration.iOSSpecific;assembly=Microsoft.Maui.Controls"
    xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
    xmlns:viewmodel="clr-namespace:FloraSaver.ViewModels"
    Title="{Binding Plant.GivenName}"
    x:DataType="viewmodel:PlantDetailsViewModel">


    <VerticalStackLayout Padding="10">

        <Frame
            Padding="20"
            BackgroundColor="Black"
            HeightRequest="660">
            <Grid RowSpacing="10">
                <Grid.RowDefinitions>
                    <RowDefinition Height="560" />
                    <RowDefinition Height="50" />
                </Grid.RowDefinitions>
                <ScrollView Grid.Row="0">

                    <VerticalStackLayout Spacing="10">

                        <Grid x:Name="plantSpeciesGrid">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="30" />
                                <RowDefinition Height="50" />
                            </Grid.RowDefinitions>
                            <Label Grid.Row="0" Text="Plant Species: " />
                            <Border
                                Grid.Row="1"
                                HorizontalOptions="Start"
                                WidthRequest="330">
                                <Entry
                                    x:Name="_PlantSpecies"
                                    Completed="Entry_Completed"
                                    Placeholder="Enter plant species"
                                    Text="{Binding Plant.PlantSpecies, StringFormat='{0}', Mode=TwoWay}"
                                    WidthRequest="320" />
                            </Border>
                        </Grid>

                        <Grid x:Name="givenNameGrid">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="30" />
                                <RowDefinition Height="50" />
                            </Grid.RowDefinitions>
                            <Label Grid.Row="0" Text="Given Name: " />
                            <Border
                                Grid.Row="1"
                                HorizontalOptions="Start"
                                WidthRequest="330">
                                <Entry
                                    x:Name="_GivenName"
                                    Completed="Entry_Completed"
                                    Placeholder="Give your plant a name!"
                                    Text="{Binding Plant.GivenName, StringFormat='{0}', Mode=TwoWay}"
                                    WidthRequest="320" />
                            </Border>
                        </Grid>

                        <Grid x:Name="dobGrid">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="30" />
                                <RowDefinition Height="50" />
                            </Grid.RowDefinitions>
                            <Label Grid.Row="0" Text="Date Of Birth: " />
                            <Border
                                Grid.Row="1"
                                HorizontalOptions="Start"
                                WidthRequest="90">
                                <DatePicker
                                    x:Name="_DateOfBirth"
                                    BackgroundColor="White"
                                    Date="{Binding Plant.DateOfBirth, Mode=TwoWay}"
                                    HorizontalOptions="Center"
                                    WidthRequest="80" />
                            </Border>
                        </Grid>

                        <Grid x:Name="wateringIntervalGrid">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="30" />
                                <RowDefinition Height="50" />
                            </Grid.RowDefinitions>
                            <Label Grid.Row="0" Text="Watering Interval: " />
                            <Border
                                Grid.Row="1"
                                HorizontalOptions="Start"
                                WidthRequest="330">
                                <Picker
                                    x:Name="waterIntervalPicker"
                                    Title="Water in _ days"
                                    ItemDisplayBinding="{Binding IntervalText, Mode=TwoWay}"
                                    ItemsSource="{Binding WateringInterval, Mode=TwoWay}"
                                    SelectedItem="{Binding WaterIntervalPickerValue, Mode=TwoWay}" />
                            </Border>
                        </Grid>

                        <Grid x:Name="customWaterInteravlGrid" IsVisible="{Binding CustomWaterInteravlGridVisible}">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="30" />
                                <RowDefinition Height="50" />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="60" />
                                <ColumnDefinition Width="40" />
                                <ColumnDefinition Width="70" />
                            </Grid.ColumnDefinitions>
                            <Label
                                Grid.Row="0"
                                Grid.ColumnSpan="3"
                                Text="Custom Interval: " />
                            <Label
                                Grid.Row="1"
                                Grid.Column="0"
                                VerticalOptions="Center">
                                Every
                            </Label>
                            <Border
                                Grid.Row="1"
                                Grid.Column="1"
                                HorizontalOptions="Start">
                                <Entry
                                    x:Name="_CustomInterval"
                                    Completed="Entry_Completed"
                                    HorizontalTextAlignment="Center"
                                    Keyboard="Numeric"
                                    Placeholder="0"
                                    Text="{Binding WaterIntervalPickerValue.DaysFromNow, Mode=TwoWay}"
                                    WidthRequest="30" />
                            </Border>
                            <Label
                                Grid.Row="1"
                                Grid.Column="2"
                                VerticalOptions="Center">
                                Days
                            </Label>
                        </Grid>

                        <Grid x:Name="WaterGrid">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="30" />
                                <RowDefinition Height="50" />
                                <RowDefinition Height="30" />
                                <RowDefinition Height="50" />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="100" />
                                <ColumnDefinition Width="25" />
                                <ColumnDefinition Width="100" />
                            </Grid.ColumnDefinitions>
                            <Label
                                Grid.Row="0"
                                Grid.ColumnSpan="3"
                                Text="Last Watered On: " />
                            <Border Grid.Row="1" Grid.Column="0">
                                <DatePicker
                                    x:Name="_DateOfLastWatering"
                                    BackgroundColor="White"
                                    Date="{Binding Plant.DateOfLastWatering, Mode=TwoWay}"
                                    Format="d" />
                            </Border>
                            <Label
                                Grid.Row="1"
                                Grid.Column="1"
                                HorizontalOptions="Center"
                                Text="at"
                                VerticalOptions="Center" />
                            <Border Grid.Row="1" Grid.Column="2">
                                <TimePicker
                                    x:Name="_TimeOfLastWatering"
                                    BackgroundColor="White"
                                    Format="t"
                                    Time="{Binding Plant.TimeOfLastWatering, Mode=TwoWay}" />
                            </Border>

                            <Label
                                Grid.Row="2"
                                Grid.ColumnSpan="3"
                                Text="Water On: " />
                            <Border Grid.Row="3" Grid.Column="0">
                                <DatePicker
                                    x:Name="_DateOfNextWatering"
                                    BackgroundColor="White"
                                    Date="{Binding Plant.DateOfNextWatering, Mode=TwoWay}"
                                    Format="d" />
                            </Border>
                            <Label
                                Grid.Row="3"
                                Grid.Column="1"
                                HorizontalOptions="Center"
                                Text="at"
                                VerticalOptions="Center" />
                            <Border Grid.Row="3" Grid.Column="2">
                                <TimePicker
                                    x:Name="_TimeOfNextWatering"
                                    BackgroundColor="White"
                                    Format="t"
                                    Time="{Binding Plant.TimeOfNextWatering, Mode=TwoWay}" />
                            </Border>
                        </Grid>

                        <Button
                            x:Name="useRefreshing"
                            Command="{Binding UseRefreshingPressedCommand}"
                            CommandParameter="{Binding RefreshGridVisible}"
                            Text="{Binding RefreshGridText}" />

                        <Grid x:Name="refreshGrid" IsVisible="{Binding RefreshGridVisible}">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="30" />
                                <RowDefinition Height="50" />
                                <RowDefinition Height="30" />
                                <RowDefinition Height="50" />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="100" />
                                <ColumnDefinition Width="25" />
                                <ColumnDefinition Width="100" />
                            </Grid.ColumnDefinitions>
                            <Label
                                Grid.Row="0"
                                Grid.ColumnSpan="3"
                                Text="Last Refreshed On: " />
                            <Border Grid.Row="1" Grid.Column="0">
                                <DatePicker
                                    x:Name="_DateOfLastRefreshing"
                                    BackgroundColor="White"
                                    Date="{Binding Plant.DateOfLastRefreshing, Mode=TwoWay}"
                                    Format="d" />
                            </Border>
                            <Label
                                Grid.Row="1"
                                Grid.Column="1"
                                HorizontalOptions="Center"
                                Text="at"
                                VerticalOptions="Center" />
                            <Border Grid.Row="1" Grid.Column="2">
                                <TimePicker
                                    x:Name="_TimeOfLastRefreshing"
                                    BackgroundColor="White"
                                    Format="t"
                                    Time="{Binding Plant.TimeOfLastRefreshing, Mode=TwoWay}" />
                            </Border>

                            <Label
                                Grid.Row="2"
                                Grid.ColumnSpan="3"
                                Text="Refresh On: " />
                            <Border Grid.Row="3" Grid.Column="0">
                                <DatePicker
                                    x:Name="_DateOfNextRefreshing"
                                    BackgroundColor="White"
                                    Date="{Binding Plant.DateOfNextRefreshing, Mode=TwoWay}"
                                    Format="d" />
                            </Border>
                            <Label
                                Grid.Row="3"
                                Grid.Column="1"
                                HorizontalOptions="Center"
                                Text="at"
                                VerticalOptions="Center" />
                            <Border Grid.Row="3" Grid.Column="2">
                                <TimePicker
                                    x:Name="_TimeOfNextRefreshing"
                                    BackgroundColor="White"
                                    Format="t"
                                    Time="{Binding Plant.TimeOfNextRefreshing, Mode=TwoWay}" />
                            </Border>
                        </Grid>

                    </VerticalStackLayout>
                </ScrollView>

                <HorizontalStackLayout Grid.Row="1" Spacing="10">
                    <Button
                        x:Name="goBack"
                        Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodel:PlantDetailsViewModel}}, Path=GoToTableCommand}"
                        IsEnabled="{Binding IsNotBusy}"
                        Text="Go Back" />
                    <Button
                        x:Name="addUpdate"
                        Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodel:PlantDetailsViewModel}}, Path=AddUpdateCommand}"
                        CommandParameter="{Binding Plant}"
                        IsEnabled="{Binding IsNotBusy}"
                        Text="Update" />
                    <Button
                        x:Name="deletePlants"
                        Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodel:PlantDetailsViewModel}}, Path=DeleteCommand}"
                        CommandParameter="{Binding Plant}"
                        IsEnabled="{Binding IsNotBusy}"
                        Text="Delete" />
                </HorizontalStackLayout>

            </Grid>
        </Frame>


        <Label x:Name="friendlyNotification" Text="{Binding FriendlyLabel}" />
    </VerticalStackLayout>
</ContentPage>
